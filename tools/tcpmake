#! /bin/csh -f

# @(#) $Header: /home/deyke/tmp/cvs/tcp/tools/tcpmake,v 1.12 1994-05-02 16:52:49 deyke Exp $

set nonomatch
tcpremove
sh < ~/tcp/lib/configure > ~/tcp/lib/configure.h
foreach dir ( \
	~/tcp \
	~/tcp/aos \
	~/tcp/bbs \
	~/tcp/convers \
	~/tcp/doc \
	~/tcp/examples \
	~/tcp/lib \
	~/tcp/src \
	~/tcp/tools \
	~/tcp/util )
	cd $dir
	foreach m (Makefile*)
		if (-f $m) then
			cp -p $m $m.old
			make -f $m depend
			if ( { cmp -s $m $m.old } ) then
				rm $m
				mv $m.old $m
			else
				rm $m.old
			endif
		endif
	end
	trimfiles
end
cd ~/tcp/src
makeall |& tee xxx
cd ~/tcp
make
mk make
