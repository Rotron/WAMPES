#! /bin/csh -f

# @(#) $Header: /home/deyke/tmp/cvs/tcp/tools/tcpmake,v 1.11 1994-02-07 12:39:16 deyke Exp $

tcpremove
sh < ~/tcp/lib/configure > ~/tcp/lib/configure.h
foreach dir ( \
	~/tcp \
	~/tcp/aos \
	~/tcp/bbs \
	~/tcp/convers \
	~/tcp/doc \
	~/tcp/examples \
	~/tcp/lib \
	~/tcp/src \
	~/tcp/tools \
	~/tcp/util )
	cd $dir
	if (-f Makefile) then
		cp -p Makefile Makefile.old
		make depend
		if ( { cmp -s Makefile Makefile.old } ) then
			rm Makefile
			mv Makefile.old Makefile
		else
			rm Makefile.old
		endif
	endif
	trimfiles
end
cd ~/tcp/src
makeall |& tee xxx
cd ~/tcp
make
mk make
