#! /bin/ksh

# @(#) $Id: trimfiles,v 1.19 1996-08-12 18:52:58 deyke Exp $

save_file()
{
	cp -p $1 $1.old
}

check_file()
{
	if cmp -s $1.old $1; then
		mv $1.old $1
	else
		rm $1.old
	fi
}

PATH=/usr/5bin:$PATH

if [[ ! -f .trimtime ]]; then
	touch 0101000070 .trimtime
fi

for file in $(find * -prune -type f \( \
	-name 'ChangeLog' -o \
	-name 'configure' -o \
	-name 'doc' -o \
	-name 'fixnetrc' -o \
	-name 'hosts' -o \
	-name 'hosts.[0-9]*' -o \
	-name 'intro.txt' -o \
	-name 'ip_routes' -o \
	-name 'Makefile' -o \
	-name 'netrom_links' -o \
	-name 'net.rc*' -o \
	-name 'notes' -o \
	-name 'README' -o \
	-name '*.conf' -o \
	-name '*.c' -o \
	-name '*.html' -o \
	-name '*.h' -o \
	-name '*.mm' -o \
	-name '*.ms' \
	\) -newer .trimtime -print); do
	save_file $file
	trim -s < $file.old > $file
	check_file $file
done
echo x > .trimtime
